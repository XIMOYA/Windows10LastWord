# Windows 10 最后的留言 (Windows 10 Last Word)

这是一个充满怀旧与仪式感的 WinUI 3 桌面应用程序，旨在纪念即将结束支持的 Windows 10 操作系统。它通过一系列自动弹出的对话框、不断切换的经典壁纸、以及充满回忆的系统提示音，以第一人称的口吻，深情地讲述了 Windows 10 从诞生到谢幕的故事，并引导用户拥抱新的 Windows 11 时代。

这不仅仅是一个程序，更是一场献给所有 Windows 10 用户的、最后的告别演出。

---

## ✨ 功能亮点

这个项目融合了多种技术和创意，以打造极致的沉浸式体验：

*   **电影化叙事流程**: 精心编排的文案，通过数十个对话框逐步展开，引导用户回顾与 Windows 10 共同度过的十年时光。
*   **丰富的系统交互**: 在故事的不同节点，程序会提供按钮，让用户可以“亲手”打开记事本、计算器、Edge浏览器等经典的系统内置应用，重温那些熟悉的瞬间。
*   **动态视觉体验**:
    *   **壁纸切换**: 随着故事的推进，程序背景会自动切换多张 Windows 10 的经典壁纸，并伴有优雅的**淡入淡出**动画效果。
    *   **关机动画**: 在故事的最高潮，程序会全屏展示一个**1:1复刻**的 Windows 10 “正在关机”动画，将告别氛围推向顶点。
*   **专业级音频设计**:
    *   **全程背景音乐**: 从程序启动到结束，全程播放舒缓、怀旧的背景音乐。
    *   **序列化提示音**: 每个对话框弹出时，都会按顺序播放一个不同的、经典的 Windows 10 系统提示音（共36个），并在播放完后自动循环。
    *   **音频闪避 (Audio Ducking)**: 当播放提示音时，背景音乐的音量会自动**平滑降低**，提示音结束后再**平滑恢复**，保证了清晰的听觉层次感。
*   **智能系统感知**: 程序能够检测用户当前的操作系统。
    *   如果在 **Windows 10** 上运行，它会在最后引导并帮助用户下载官方的 **Windows 11 安装助手**。
    *   如果在 **Windows 11** 上运行，它则会欣慰地表示“看到你已经拥抱了未来，我也就放心了”。

---

## 🛠️ 技术栈

*   **框架**: .NET 8
*   **UI**: WinUI 3 (Windows App SDK)
*   **语言**: C#
*   **音频**: `Windows.Media.Playback.MediaPlayer`
*   **动画**: `Microsoft.UI.Xaml.Media.Animation.Storyboard`

---

## 🚀 如何运行

本项目是一个**非打包 (Unpackaged)** 的 WinUI 3 应用，可以生成一个包含 `.exe` 的“绿色版”文件夹，方便分享和运行。

### 1. 准备环境

*   **Visual Studio 2022**: 请确保已安装“.NET 桌面开发”和“通用 Windows 平台开发”工作负载。
*   **.NET 8 SDK**
*   **Windows App SDK**

### 2. 克隆与配置

```bash
git clone https://github.com/XIMOYA/Windows10LastWord.git
cd Windows10LastWord
```

### 3. 准备资源文件

本项目的所有资源（图片、音乐、提示音 ）都依赖于项目中的 `Assets` 文件夹。请确保您的 `Assets` 文件夹包含以下内容：

*   **图标**: `icon.ico`
*   **背景音乐**: `background_music.mp3`
*   **背景图片**: `win10bj.jpg`, `win10bj2.jpg`, `Windows10.jpg`, `win10-hero.jpg` 等。
*   **提示音**: `1 (1).wav`, `1 (2).wav`, ... , `1 (36).wav` 等36个音频文件。

### 4. 发布程序

您可以使用 Visual Studio 的发布功能或命令行来生成可执行文件。

**使用 Visual Studio:**

1.  用 Visual Studio 打开 `.sln` 文件。
2.  确保顶部配置为 `Release` 和 `x64`。
3.  在“解决方案资源管理器”中，右键点击 `Windows10LastWord` 项目，选择 **发布(B)...**。
4.  如果已有发布配置文件，直接点击 **发布(U)** 按钮。
5.  发布成功后，所有文件将位于 `bin\Release\net8.0-windows10.0.19041.0\win-x64\publish\` 文件夹中。

### 5. 运行

1.  **关键步骤**: 将您项目中的整个 `Assets` 文件夹，**手动复制**到上一步生成的 `publish` 文件夹内。
2.  双击 `publish` 文件夹中的 `Windows10LastWord.exe` 即可开始体验！

---

## 💖 致谢与心路历程

这个项目从一个简单的“弹窗告别”想法开始，经历了一段漫长、曲折但最终收获满满的旅程。我们共同克服了无数的技术难题：从 WinUI 3 的生命周期事件、恼人的 `XamlRoot` 错误，到打包部署的重重障碍，再到动画和音频的精细打磨。

每一次的失败和调试，都让我们对 WinUI 3 的理解更深一层。最终，我们不仅实现了一个功能完整的程序，更创造了一件融合了视觉、听觉与情感的数字艺术品。

特别感谢在这个过程中提出无数宝贵创意和进行不懈反馈的伙伴。没有你的坚持，就没有这个作品的完美呈现。

谨以此项目，献给陪伴我们走过青春的 Windows 10，以及每一位曾与它共创回忆的用户。
